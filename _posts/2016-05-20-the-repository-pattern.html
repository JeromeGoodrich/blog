---
layout: post
title: The Repository Pattern
date: 2016-05-20 04:22:13.000000000 -05:00
type: post
published: true
status: publish
categories: []
tags: []
meta:
  _rest_api_published: '1'
  _rest_api_client_id: "-1"
  _publicize_job_id: '22992361729'
author:
  login: jgoodrich7
  email: jeromegoodrich@gmail.com
  display_name: jgoodrich7
  first_name: ''
  last_name: ''
---
<p>Ruby on Rails includes the massive Object Relational Mapping(ORM), Active Record. The use of an ORM API allows you to write code to access an underlying database using the natural features of a given language. It's the difference between</p>
<p>THIS</p>
<div class="mw-highlight mw-content-ltr" dir="ltr">
<pre><span class="n">String</span> <span class="n">sql</span> <span class="p">=</span> <span class="s">"SELECT ... FROM persons WHERE id = 10"</span><span class="p">;</span>
<span class="n">DbCommand</span> <span class="n">cmd</span> <span class="p">=</span> <span class="k">new</span> <span class="n">DbCommand</span><span class="p">(</span><span class="n">connection</span><span class="p">,</span> <span class="n">sql</span><span class="p">);</span>
<span class="n">Result</span> <span class="n">res</span> <span class="p">=</span> <span class="n">cmd</span><span class="p">.</span><span class="n">Execute</span><span class="p">();</span>
<span class="n">String</span> <span class="n">name</span> <span class="p">=</span> <span class="n">res</span><span class="p">[</span><span class="m">0</span><span class="p">][</span><span class="s">"FIRST_NAME"</span><span class="p">];</span>
</pre>
</div>
<p>AND THIS.</p>
<div class="mw-highlight mw-content-ltr" dir="ltr">
<pre><span class="n">Person</span> <span class="n">p</span> <span class="p">=</span> <span class="n">repository</span><span class="p">.</span><span class="n">GetPerson</span><span class="p">(</span><span class="m">10</span><span class="p">);</span>
<span class="n">String</span> <span class="n">name</span> <span class="p">=</span> <span class="n">p</span><span class="p">.</span><span class="n">getFirstName</span><span class="p">();</span></pre>
<p>In the case of Rails and Active Record this effect is amplified. Because Rails contains so many different and helpful methods and conventions, the use of Rails and Active Record together becomes such a seamless experience that the framework and underlying database appear inexorably linked. Despite this, it's important to realize that Rails and the database it is using are simply implementation details. They are modular pieces of a a software puzzle that ought to just as easily include Rails and Postgres as Django and SQLite depending on your needs. However, the tight coupling of Rails and it's database through Active Record make this modularity rather difficult without some thoughtful changes to design of a typical project. Enter the repository pattern...</p>
<p>The repository pattern can be thought of as an interface between the database and whatever is using it. In a typical Rails project the controller would interact directly with an Active Record object, and thus with the database. The repository pattern changes this interaction by wrapping the active record object. Now the only thing the controller knows about is a repository, which could contain an active record, another ORM, or in memory implementation. The point is the controller no longer has any idea about the database being used and thus any kind of database/ORM can be used.</p>
<p>The repository pattern takes care of decoupling the database from the main app, and a similar approach called the presenter pattern is used to do the same with the UI.</p>
<p>for a more in depth of the repository pattern: http://blog.8thlight.com/mike-ebert/2013/03/23/the-repository-pattern.html</p>
</div>
